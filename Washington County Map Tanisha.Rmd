---
title: "Washington County Profile"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 2
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '2'
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE)
```

```{r}
library(tidyverse)
library(janitor)
library(sf)
library(tigris)
library(tmap)
library(tidycensus)
library(scales)


```

```{r echo = FALSE, include = FALSE}

# I'm including several things in this code chunk that I don't want to show up when I knit. 
# Hence, the echo = FALSE and include = FALSE

# I'll tell tigris to always download sf format data
options(tigris_class = "sf",
        tigris_use_cache = TRUE)

# Download the data into a data frame called oregon_counties
wash_co_shapefile <- counties(state = "OR",
                              cb = TRUE) %>% 
  clean_names() %>% 
  filter(name == "Washington")


v17 <- load_variables(year = 2017, 
                      dataset = "acs5", 
                      cache = TRUE)

tmap_mode("view")
```

 API Census Key

```{r}
census_api_key("f1ac2dafc38949bda5582a828d3dfb0ba4357658", overwrite = FALSE, install = FALSE)
```

# Median Household Income

```{r}
median_income <- get_acs(geography = "tract",
                         geometry = TRUE,
                         year = 2017,
                         survey = "acs5",
                         state = "OR",
                         county = "Washington",
                         variables = (median_income = "B19013_001")) %>% 
  clean_names() %>% 
  mutate(plot_label = dollar(estimate))

tm_shape(median_income) +
  tm_sf(col = "estimate",
        alpha = 0.25,
        title = "Median Income",
        legend.format=list(fun=function(x) paste0("$", formatC(x, digits=0, format="f"))))


```

# Race/Ethnicity

## African American Male Population Under 5 Years of Age
```{r}
af_am_male <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (african_american_male5andunder = "B01001B_003"),
                 summary_var = "B01001_003") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(af_am_male) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "African American Males Population Under 5years of Age",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## African American Female Population Under 5 Years of Age
```{r}
af_am_female <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (african_american_female5andunder = "B01001B_018"),
                 summary_var = "B01001_027") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(af_am_female) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "African American Female Population under Age 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## White Male Population Under Age 5
```{r}
white_male <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (white_male_popunder5 = "B01001A_003"),
                 summary_var = "B01001_003") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(white_male) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "White Male Population under Age 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## White Female Population Under Age 5
```{r}
white_female <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (white_female_popunder5 = "B01001A_018"),
                 summary_var = "B01001_027") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(white_female) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "White Female Population under Age 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## American Indian and Alaska Native Population Under Age 5

```{r}
AmIn_male <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (americanindian_male_popunder5 = "B01001C_003"),
                 summary_var = "B01001_003") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(AmIn_male) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "American Indian and Alaska Native Male Population under Age 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

-B01001_027 - total Female under Age 5
-B01001_003 - total Male under age 5

## American Indian and Alaska Native Female Population Under Age 5
```{r}
AmIn_female <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (americanindian_female_popunder5 = "B01001C_018"),
                 summary_var = "B01001_027") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(AmIn_female) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "American Indian and Alaska Native Female Population under Age 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```


## Asian Male Population Under Age 5
```{r}
asian_male <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (asian_maleunder5 = "B01001D_003"),
                 summary_var = "B01001_003") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(asian_male) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Asian Male Population for Children Under 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## Asian Female Population for Children Under 5
```{r}
asian_female <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (asian_female_under5 = "B01001D_018"),
                 summary_var = "B01001_027") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(asian_female) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Asian Female Population for Children Under 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## Native Hawaiian and Other Pacific Islanders Female Population for Children Under Age 5
```{r}
natHaw_female <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (NatHawii__female_under5 = "B01001E_018"),
                 summary_var = "B01001_027") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(natHaw_female) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Native Hawaiian and Other Pacific Islanders Female Population for Children Under 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## Native Hawaiian and Other Pacific Islanders Male Population for Children Under 5
```{r}
natHaw_male <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (NatHawii__male_under5 = "B01001E_003"),
                 summary_var = "B01001_003") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(natHaw_male) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Native Hawaiian and Other Pacific Islanders Male Population for Children Under 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

## Hispanic or Latino Male Population for Children Under 5
```{r}
Latin_male <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (Latin_male_under5 = "B01001I_003"),
                 summary_var = "B01001_003") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(Latin_male) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Hispanic or Latino Male Population for Children Under 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

##Hispanic or Latino Female Population for Children Under Age 5 
```{r}
Latin_female <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (Latin_female_under5 = "B01001I_018"),
                 summary_var = "B01001_027") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(Latin_female) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Hispanic or Latino Female Population for Children Under 5",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %"))) 
```

# Home/Primary Language
```{r}
Home_Spanish <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (home_spanish = "B16003_004"),
                 summary_var = "B16003_002") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(Home_Spanish) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Home Language for Children over 5yrs: Spanish",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %")))
```

```{r}
Home_indo_european <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (home_indo_european = "B16003_005"),
                 summary_var = "B16003_002") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(Home_indo_european) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Home Language for Children over 5yrs: Indo-European Languages",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %")))
```
```{r}
Home_asian_pacific <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (home_asian_pacific = "B16003_006"),
                 summary_var = "B16003_002") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(Home_asian_pacific) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Home Language for Children over 5yrs: Asian Pacific Island Languages",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %")))
```

```{r}
Home_other <- get_acs(geography = "tract",
                 geometry = TRUE,
                 year = 2017,
                 survey = "acs5",
                 state = "OR",
                 county = "Washington",
                 variables = (home_other = "B16003_007"),
                 summary_var = "B16003_002") %>% 
  clean_names() %>% 
  mutate(pct = (estimate / summary_est) * 100) 

tm_shape(Home_other) +
  tm_sf(col = "pct",
        alpha = 0.25,
        title = "Home Language for Children over 5yrs: Other Languages",
        legend.format=list(fun=function(x) paste0(formatC(x, digits=0, format="f"), " %")))
```





